{"version":3,"sources":["components/canvas/Canvas.tsx","components/layers/InputLayer.tsx","components/layers/Conv2DLayer.tsx","components/layers/OutputLayer.tsx","components/layers/ConcatLayer.tsx","components/layers/LinearLayer.tsx","components/layers/FlattenLayer.tsx","components/layers/MaxPoolLayer.tsx","components/sidebar/LayerLibrary.tsx","components/sidebar/PropertiesPanel.tsx","components/controls/Toolbar.tsx","App.tsx","index.js"],"names":["layerComponentMap","InputLayer","_ref","inputShape","_jsxs","style","userSelect","children","_jsx","margin","fontSize","color","fontWeight","textShadow","marginTop","background","padding","borderRadius","border","join","Conv2DLayer","filterSize","numFilters","activationFunction","localFilterSize","setLocalFilterSize","useState","localNumFilters","setLocalNumFilters","localActivationFunction","setLocalActivationFunction","className","marginBottom","type","value","onChange","event","Number","target","backgroundColor","width","marginLeft","outline","OutputLayer","outputShape","localActivation","setLocalActivation","ConcatLayer","layers","length","LinearLayer","inputSize","outputSize","bias","activation","minWidth","textAlign","FlattenLayer","startDim","endDim","MaxPoolLayer","poolSize","stride","defaultParams","Canvas","React","forwardRef","props","ref","setLayers","connections","setConnections","draggedId","setDraggedId","dragOffset","setDragOffset","x","y","connecting","setConnecting","from","to","selectedLayerId","setSelectedLayerId","connectionPreview","setConnectionPreview","nearbyHandle","setNearbyHandle","canvasTransform","setCanvasTransform","scale","isPanning","setIsPanning","panStart","setPanStart","canvasRef","useRef","contentRef","useEffect","handleKeyDown","e","activeElement","document","HTMLInputElement","HTMLTextAreaElement","HTMLSelectElement","key","prev","filter","l","id","conn","preventDefault","addEventListener","removeEventListener","handleWheel","useCallback","cancelable","current","rect","getBoundingClientRect","mouseX","clientX","left","mouseY","clientY","top","delta","deltaY","scaleFactor","Math","max","min","newX","newY","handlePanStart","button","ctrlKey","handlePanMove","_objectSpread","handlePanEnd","resetTransform","screenToCanvas","screenX","screenY","canvasToScreen","canvasX","canvasY","handleConnectionStart","console","log","stopPropagation","handleConnectionEnd","connectingFrom","existingConnectionIndex","findIndex","_","index","fromId","getModelData","map","layer","parameters","position","connection","useImperativeHandle","layerId","element","currentWidth","offsetWidth","existingLayer","find","forEach","querySelector","concat","HTMLDivElement","getHandlePosition","nodeWidth","height","overflow","backgroundSize","cursor","boxShadow","onWheel","onMouseDown","onMouseMove","canvasCoords","fromLayer","fromPos","fromScreen","closestHandle","minDistance","inputPos","inputScreen","distance","sqrt","pow","targetLayer","targetPos","targetScreen","onMouseUp","handleMouseUp","onClick","onDragOver","onDrop","_canvasRef$current","data","dataTransfer","getData","JSON","parse","includes","t","dropX","dropY","undefined","handleDrop","error","tabIndex","right","zIndex","display","flexDirection","gap","round","bottom","backdropFilter","transform","transformOrigin","pointerEvents","backgroundImage","backgroundPosition","LayerComponent","isSelected","isConnecting","isNearbyTarget","getLayerGradient","paramInputs","Object","keys","param","displayValue","Array","isArray","String","handleParamChange","convertedValue","isNaN","trim","split","v","_unused","placeholder","onFocus","transition","title","WebkitUserSelect","MozUserSelect","msUserSelect","handleMouseDown","HTMLLabelElement","offsetX","offsetY","opacity","renderConnections","connectionLines","toLayer","toScreen","x1","y1","x2","y2","stroke","strokeWidth","markerEnd","previewLine","strokeDasharray","markerWidth","markerHeight","refX","refY","orient","points","fill","LayerLibrary","adWrapperRef","wrapper","script","createElement","async","setAttribute","src","appendChild","innerHTML","borderRight","overflowY","borderBottom","paddingBottom","letterSpacing","name","icon","draggable","onDragStart","handleDragStart","layerType","layerData","Date","now","random","setData","stringify","alignItems","currentTarget","onMouseOver","onMouseOut","borderTopLeftRadius","borderBottomLeftRadius","justifyContent","textTransform","minHeight","PropertiesPanel","trainingOptions","onOptionChange","adContainerRef","container","configScript","text","invokeScript","borderLeft","batchSize","boxSizing","epochs","step","learningRate","optimizer","lossFunction","Toolbar","onExport","onImport","WebkitBackgroundClip","WebkitTextFillColor","paddingLeft","lineHeight","fontStyle","App","exportStatus","setExportStatus","isExporting","message","isError","setTrainingOptions","modelData","exportData","isHttps","window","location","protocol","metaTag","apiBase","getAttribute","process","replace","sameOrigin","origin","candidates","Boolean","seen","Set","endpoints","u","has","add","result","lastError","url","controller","AbortController","timeoutId","setTimeout","abort","response","fetch","method","mode","cache","headers","body","signal","clearTimeout","isJson","get","payload","json","ok","msg","slice","Error","status","err","success","blob","Blob","URL","createObjectURL","a","href","download","click","removeChild","revokeObjectURL","flex","handleOptionChange","option","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.568aa4b8.chunk.js","sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport InputLayer from '../layers/InputLayer';\nimport Conv2DLayer from '../layers/Conv2DLayer';\nimport OutputLayer from '../layers/OutputLayer';\nimport ConcatLayer from '../layers/ConcatLayer';\nimport LinearLayer from '../layers/LinearLayer';\nimport FlattenLayer from '../layers/FlattenLayer';\nimport MaxPoolLayer from '../layers/MaxPoolLayer';\n\ntype LayerType = 'InputLayer' | 'Conv2DLayer' | 'OutputLayer' | 'ConcatLayer' | 'LinearLayer' | 'FlattenLayer' | 'MaxPoolLayer';\n\ninterface LayerProps {\n    [key: string]: any;\n}\n\nconst layerComponentMap: Record<LayerType, React.ComponentType<LayerProps>> = {\n    InputLayer: InputLayer,\n    Conv2DLayer: Conv2DLayer,\n    OutputLayer: OutputLayer,\n    ConcatLayer: ConcatLayer,\n    LinearLayer: LinearLayer,\n    FlattenLayer: FlattenLayer,\n    MaxPoolLayer: MaxPoolLayer,\n};\n\nconst defaultParams: Record<LayerType, Record<string, any>> = {\n    InputLayer: { inputShape: [28, 28, 1] },\n    Conv2DLayer: { filterSize: 3, numFilters: 32, activationFunction: 'relu' },\n    OutputLayer: { outputShape: [10], activationFunction: 'softmax' },\n    ConcatLayer: { layers: [] },\n    LinearLayer: { inputSize: 128, outputSize: 64, bias: true, activation: 'relu' },\n    FlattenLayer: { startDim: 1, endDim: -1 },\n    MaxPoolLayer: { poolSize: 2, stride: 2, padding: 'valid' },\n};\n\ninterface DroppedLayer {\n    type: LayerType;\n    id: number;\n    parameters: Record<string, any>;\n    x: number;\n    y: number;\n    selected?: boolean;\n    width?: number; // Add width property\n}\n\ninterface Connection {\n    from: number;\n    to: number;\n}\n\nconst Canvas = React.forwardRef<{getModelData: () => any}, React.PropsWithChildren<{}>>((props, ref) => {\n    const [layers, setLayers] = useState<DroppedLayer[]>([]);\n    const [connections, setConnections] = useState<Connection[]>([]);\n    const [draggedId, setDraggedId] = useState<number | null>(null);\n    const [dragOffset, setDragOffset] = useState<{ x: number; y: number }>({ x: 0, y: 0 });\n    const [connecting, setConnecting] = useState<{ from: number | null, to: number | null }>({ from: null, to: null });\n    const [selectedLayerId, setSelectedLayerId] = useState<number | null>(null);\n    const [connectionPreview, setConnectionPreview] = useState<{ from: { x: number; y: number }, to: { x: number; y: number } } | null>(null);\n    const [nearbyHandle, setNearbyHandle] = useState<number | null>(null);\n    \n    // Canvas transform state\n    const [canvasTransform, setCanvasTransform] = useState({ \n        x: 0, \n        y: 0, \n        scale: 1 \n    });\n    const [isPanning, setIsPanning] = useState(false);\n    const [panStart, setPanStart] = useState({ x: 0, y: 0 });\n    \n    const canvasRef = useRef<HTMLDivElement>(null);\n    const contentRef = useRef<HTMLDivElement>(null);\n\n    // Keyboard event handler for deleting selected nodes\n    useEffect(() => {\n        const handleKeyDown = (e: KeyboardEvent) => {\n            // Don't delete if user is typing in an input field\n            const activeElement = document.activeElement;\n            if (activeElement instanceof HTMLInputElement || \n                activeElement instanceof HTMLTextAreaElement || \n                activeElement instanceof HTMLSelectElement) {\n                return;\n            }\n\n            if ((e.key === 'Delete' || e.key === 'Backspace') && selectedLayerId !== null) {\n                // Remove the selected layer\n                setLayers(prev => prev.filter(l => l.id !== selectedLayerId));\n                // Remove all connections involving this layer\n                setConnections(prev => prev.filter(\n                    conn => conn.from !== selectedLayerId && conn.to !== selectedLayerId\n                ));\n                setSelectedLayerId(null);\n                e.preventDefault();\n            }\n        };\n\n        document.addEventListener('keydown', handleKeyDown);\n        return () => document.removeEventListener('keydown', handleKeyDown);\n    }, [selectedLayerId]);\n\n    // Zoom and pan controls - reduced sensitivity\n    const handleWheel = useCallback((e: React.WheelEvent) => {\n        // Only call preventDefault if needed and if it's not a passive listener\n        if (e.cancelable) {\n            e.preventDefault();\n        }\n        \n        if (!canvasRef.current) return;\n        \n        const rect = canvasRef.current.getBoundingClientRect();\n        const mouseX = e.clientX - rect.left;\n        const mouseY = e.clientY - rect.top;\n        \n        // Reduced sensitivity: changed from -0.01 to -0.001\n        const delta = e.deltaY * -0.001;\n        const scaleFactor = Math.max(0.1, Math.min(3, canvasTransform.scale + delta));\n        \n        // Calculate new position to zoom towards mouse position\n        const newX = mouseX - (mouseX - canvasTransform.x) * (scaleFactor / canvasTransform.scale);\n        const newY = mouseY - (mouseY - canvasTransform.y) * (scaleFactor / canvasTransform.scale);\n        \n        setCanvasTransform({\n            x: newX,\n            y: newY,\n            scale: scaleFactor\n        });\n    }, [canvasTransform]);\n\n    const handlePanStart = useCallback((e: React.MouseEvent) => {\n        // Only start panning if middle mouse button or space + left click\n        if (e.button === 1 || (e.button === 0 && e.ctrlKey)) {\n            e.preventDefault();\n            setIsPanning(true);\n            setPanStart({ x: e.clientX - canvasTransform.x, y: e.clientY - canvasTransform.y });\n        }\n    }, [canvasTransform]);\n\n    const handlePanMove = useCallback((e: React.MouseEvent) => {\n        if (isPanning) {\n            e.preventDefault();\n            setCanvasTransform(prev => ({\n                ...prev,\n                x: e.clientX - panStart.x,\n                y: e.clientY - panStart.y\n            }));\n        }\n    }, [isPanning, panStart]);\n\n    const handlePanEnd = useCallback(() => {\n        setIsPanning(false);\n    }, []);\n\n    // Reset zoom and pan\n    const resetTransform = useCallback(() => {\n        setCanvasTransform({ x: 0, y: 0, scale: 1 });\n    }, []);\n\n    // Convert screen coordinates to canvas coordinates\n    const screenToCanvas = useCallback((screenX: number, screenY: number) => {\n        return {\n            x: (screenX - canvasTransform.x) / canvasTransform.scale,\n            y: (screenY - canvasTransform.y) / canvasTransform.scale\n        };\n    }, [canvasTransform]);\n\n    // Convert canvas coordinates to screen coordinates\n    const canvasToScreen = useCallback((canvasX: number, canvasY: number) => {\n        return {\n            x: canvasX * canvasTransform.scale + canvasTransform.x,\n            y: canvasY * canvasTransform.scale + canvasTransform.y\n        };\n    }, [canvasTransform]);\n\n    // Add new layer at the mouse drop position - fixed for transforms\n    const handleDrop = (layer: { type: string; id: number; x?: number; y?: number }) => {\n        // Only allow valid LayerType\n        if (!['InputLayer', 'Conv2DLayer', 'OutputLayer', 'ConcatLayer', 'LinearLayer', 'FlattenLayer', 'MaxPoolLayer'].includes(layer.type)) {\n            return;\n        }\n        \n        const validLayerTypes: LayerType[] = ['InputLayer', 'Conv2DLayer', 'OutputLayer', 'ConcatLayer', 'LinearLayer', 'FlattenLayer', 'MaxPoolLayer'];\n        const type = validLayerTypes.find(t => t === layer.type);\n        \n        if (!type) {\n            return;\n        }\n\n        // Convert drop position to canvas coordinates if provided\n        let dropX = 100;\n        let dropY = 100;\n        \n        if (layer.x !== undefined && layer.y !== undefined) {\n            const canvasCoords = screenToCanvas(layer.x, layer.y);\n            dropX = canvasCoords.x;\n            dropY = canvasCoords.y;\n        }\n        \n        setLayers(prev => [\n            ...prev,\n            {\n                ...layer,\n                type: type,\n                parameters: { ...defaultParams[type] },\n                x: dropX,\n                y: dropY,\n            },\n        ]);\n    };\n\n    // Improved drag logic with input element detection and selection\n    const handleMouseDown = (id: number, e: React.MouseEvent) => {\n        // Prevent dragging if clicking on input elements, labels, or select elements\n        const target = e.target;\n        if (target instanceof HTMLInputElement || \n            target instanceof HTMLLabelElement || \n            target instanceof HTMLSelectElement) {\n            return;\n        }\n\n        // Don't start dragging if we're connecting or panning\n        if (connecting.from !== null || isPanning) {\n            return;\n        }\n\n        // Set selected layer\n        setSelectedLayerId(id);\n\n        if (!canvasRef.current) return;\n        \n        const layer = layers.find(l => l.id === id);\n        if (!layer) return;\n        \n        const rect = canvasRef.current.getBoundingClientRect();\n        const screenX = e.clientX - rect.left;\n        const screenY = e.clientY - rect.top;\n        const canvasCoords = screenToCanvas(screenX, screenY);\n        \n        // Calculate offset from mouse position to layer's top-left corner\n        const offsetX = canvasCoords.x - layer.x;\n        const offsetY = canvasCoords.y - layer.y;\n        \n        setDraggedId(id);\n        setDragOffset({ x: offsetX, y: offsetY });\n        e.stopPropagation();\n    };\n\n    // Click outside to deselect\n    const handleCanvasClick = (e: React.MouseEvent) => {\n        if (e.target === canvasRef.current) {\n            setSelectedLayerId(null);\n        }\n    };\n\n    const handleMouseUp = () => {\n        setDraggedId(null);\n        setDragOffset({ x: 0, y: 0 });\n        handlePanEnd();\n        \n        // End connection if we're connecting\n        if (connecting.from !== null) {\n            setConnecting({ from: null, to: null });\n            setConnectionPreview(null);\n            setNearbyHandle(null);\n        }\n    };\n\n    const handleMouseMove = (e: React.MouseEvent) => {\n        if (!canvasRef.current) return;\n        \n        const rect = canvasRef.current.getBoundingClientRect();\n        const screenX = e.clientX - rect.left;\n        const screenY = e.clientY - rect.top;\n        const canvasCoords = screenToCanvas(screenX, screenY);\n\n        // Handle panning\n        handlePanMove(e);\n\n        // Handle node dragging\n        if (draggedId !== null && !isPanning) {\n            const x = canvasCoords.x - dragOffset.x;\n            const y = canvasCoords.y - dragOffset.y;\n            setLayers(prev => prev.map(l => l.id === draggedId ? { ...l, x, y } : l));\n        }\n\n        // Handle connection preview\n        if (connecting.from !== null) {\n            const fromLayer = layers.find(l => l.id === connecting.from);\n            if (fromLayer) {\n                const fromPos = getHandlePosition(fromLayer, 'output');\n                const fromScreen = canvasToScreen(fromPos.x, fromPos.y);\n                \n                // Check for nearby input handles\n                let closestHandle: number | null = null;\n                let minDistance = 30; // Snap distance\n                \n                layers.forEach(layer => {\n                    if (layer.id !== connecting.from) {\n                        const inputPos = getHandlePosition(layer, 'input');\n                        const inputScreen = canvasToScreen(inputPos.x, inputPos.y);\n                        const distance = Math.sqrt(\n                            Math.pow(screenX - inputScreen.x, 2) + Math.pow(screenY - inputScreen.y, 2)\n                        );\n                        \n                        if (distance < minDistance) {\n                            minDistance = distance;\n                            closestHandle = layer.id;\n                        }\n                    }\n                });\n                \n                setNearbyHandle(closestHandle);\n                \n                // Set preview line (in screen coordinates for SVG)\n                if (closestHandle) {\n                    const targetLayer = layers.find(l => l.id === closestHandle);\n                    if (targetLayer) {\n                        const targetPos = getHandlePosition(targetLayer, 'input');\n                        const targetScreen = canvasToScreen(targetPos.x, targetPos.y);\n                        setConnectionPreview({\n                            from: fromScreen,\n                            to: targetScreen\n                        });\n                    }\n                } else {\n                    setConnectionPreview({\n                        from: fromScreen,\n                        to: { x: screenX, y: screenY }\n                    });\n                }\n            }\n        }\n    };\n\n    // Inline parameter editing with proper type conversion\n    const handleParamChange = (id: number, param: string, value: string) => {\n        setLayers(prev => prev.map(l => {\n            if (l.id === id) {\n                let convertedValue: any = value;\n                \n                // Convert numeric strings to numbers\n                if (!isNaN(Number(value)) && value.trim() !== '') {\n                    convertedValue = Number(value);\n                }\n                \n                // Handle array inputs (for inputShape, outputShape)\n                if (param.includes('Shape') && typeof value === 'string') {\n                    try {\n                        // Parse comma-separated values as array\n                        convertedValue = value.split(',').map(v => Number(v.trim())).filter(v => !isNaN(v));\n                    } catch {\n                        convertedValue = value;\n                    }\n                }\n                \n                return { ...l, parameters: { ...l.parameters, [param]: convertedValue } };\n            }\n            return l;\n        }));\n    };\n\n    // Connection logic with handles\n    const handleConnectionStart = (id: number, type: 'input' | 'output', e: React.MouseEvent) => {\n        console.log('Connection start:', { id, type }); // Debug log\n        e.preventDefault();\n        e.stopPropagation();\n        \n        if (type === 'output') {\n            setConnecting({ from: id, to: null });\n            console.log('Started connecting from node:', id); // Debug log\n        }\n    };\n\n    const handleConnectionEnd = (id: number, type: 'input' | 'output', e: React.MouseEvent) => {\n        console.log('Connection end:', { id, type, connectingFrom: connecting.from }); // Debug log\n        e.preventDefault();\n        e.stopPropagation();\n        \n        if (type === 'input' && connecting.from !== null && connecting.from !== id) {\n            // Check if connection already exists\n            const existingConnectionIndex = connections.findIndex(\n                conn => conn.from === connecting.from && conn.to === id\n            );\n            \n            if (existingConnectionIndex !== -1) {\n                // Disconnect if connection exists\n                console.log('Removing existing connection'); // Debug log\n                setConnections(prev => prev.filter((_, index) => index !== existingConnectionIndex));\n            } else {\n                // Connect if no connection exists\n                console.log('Creating new connection from', connecting.from, 'to', id); // Debug log\n                const fromId: number = connecting.from;\n                setConnections(prev => [...prev, { from: fromId, to: id }]);\n            }\n        }\n        \n        // Always clear connection state\n        setConnecting({ from: null, to: null });\n        setConnectionPreview(null);\n        setNearbyHandle(null);\n    };\n\n    // Function to get all model data for export\n    const getModelData = () => {\n        return {\n            layers: layers.map(layer => ({\n                id: layer.id,\n                type: layer.type,\n                parameters: layer.parameters,\n                position: { x: layer.x, y: layer.y }\n            })),\n            connections: connections.map(connection => ({\n                from: connection.from,\n                to: connection.to\n            }))\n        };\n    };\n    \n    // Expose the getModelData function via ref\n    React.useImperativeHandle(ref, () => ({\n        getModelData\n    }));\n    \n    // Function to update node width after render - optimized to prevent infinite loops\n    const updateNodeWidth = useCallback((layerId: number, element: HTMLDivElement | null) => {\n        if (element) {\n            const currentWidth = element.offsetWidth;\n            \n            // Only update if width has actually changed\n            setLayers(prev => {\n                const existingLayer = prev.find(layer => layer.id === layerId);\n                if (existingLayer && existingLayer.width !== currentWidth) {\n                    return prev.map(layer => \n                        layer.id === layerId \n                            ? { ...layer, width: currentWidth }\n                            : layer\n                    );\n                }\n                return prev;\n            });\n        }\n    }, []);\n\n    // Use useEffect to measure width after initial render instead of ref callback\n    useEffect(() => {\n        layers.forEach(layer => {\n            if (!layer.width) {\n                const element = document.querySelector(`[data-layer-id=\"${layer.id}\"]`);\n                if (element && element instanceof HTMLDivElement) {\n                    const width = element.offsetWidth;\n                    setLayers(prev => prev.map(l => \n                        l.id === layer.id ? { ...l, width } : l\n                    ));\n                }\n            }\n        });\n    }, [layers.length]); // Only run when number of layers changes\n\n    // Helper function to get handle positions - using actual width\n    const getHandlePosition = (layer: DroppedLayer, type: 'input' | 'output') => {\n        if (type === 'input') {\n            return {\n                x: layer.x - 8,\n                y: layer.y + 50\n            };\n        } else {\n            const nodeWidth = layer.width || 270;\n            return {\n                x: layer.x + nodeWidth + 8,\n                y: layer.y + 50\n            };\n        }\n    };\n\n    // Update connection line positions to connect handles\n    const getLayerCenter = (layer: DroppedLayer) => {\n        return {\n            x: layer.x + 60,\n            y: layer.y + 50\n        };\n    };\n\n    // Updated render connections to use screen coordinates\n    const renderConnections = () => {\n        const connectionLines = connections.map((connection, index) => {\n            const fromLayer = layers.find(l => l.id === connection.from);\n            const toLayer = layers.find(l => l.id === connection.to);\n            \n            if (!fromLayer || !toLayer) return null;\n            \n            const from = getHandlePosition(fromLayer, 'output');\n            const to = getHandlePosition(toLayer, 'input');\n            const fromScreen = canvasToScreen(from.x, from.y);\n            const toScreen = canvasToScreen(to.x, to.y);\n            \n            return (\n                <line\n                    key={`connection-${index}`}\n                    x1={fromScreen.x}\n                    y1={fromScreen.y}\n                    x2={toScreen.x}\n                    y2={toScreen.y}\n                    stroke=\"#007acc\"\n                    strokeWidth={2}\n                    markerEnd=\"url(#arrowhead)\"\n                />\n            );\n        });\n\n        // Add preview connection\n        const previewLine = connectionPreview && (\n            <line\n                key=\"preview\"\n                x1={connectionPreview.from.x}\n                y1={connectionPreview.from.y}\n                x2={connectionPreview.to.x}\n                y2={connectionPreview.to.y}\n                stroke={nearbyHandle ? \"#4caf50\" : \"#ffa726\"}\n                strokeWidth={2}\n                strokeDasharray=\"5,5\"\n                markerEnd=\"url(#previewArrowhead)\"\n            />\n        );\n\n        return (\n            <svg\n                style={{\n                    position: 'absolute',\n                    top: 0,\n                    left: 0,\n                    width: '100%',\n                    height: '100%',\n                    pointerEvents: 'none',\n                    zIndex: 15 // Higher than canvas content but lower than handles\n                }}\n            >\n                <defs>\n                    <marker\n                        id=\"arrowhead\"\n                        markerWidth=\"10\"\n                        markerHeight=\"7\"\n                        refX=\"9\"\n                        refY=\"3.5\"\n                        orient=\"auto\"\n                    >\n                        <polygon\n                            points=\"0 0, 10 3.5, 0 7\"\n                            fill=\"#007acc\"\n                        />\n                    </marker>\n                    <marker\n                        id=\"previewArrowhead\"\n                        markerWidth=\"10\"\n                        markerHeight=\"7\"\n                        refX=\"9\"\n                        refY=\"3.5\"\n                        orient=\"auto\"\n                    >\n                        <polygon\n                            points=\"0 0, 10 3.5, 0 7\"\n                            fill={nearbyHandle ? \"#4caf50\" : \"#ffa726\"}\n                        />\n                    </marker>\n                </defs>\n                {connectionLines}\n                {previewLine}\n            </svg>\n        );\n    };\n\n    return (\n        <div\n            className=\"canvas\"\n            ref={canvasRef}\n            style={{ \n                height: '100%',\n                width: '100%',\n                border: '1px solid rgba(255, 255, 255, 0.05)', \n                position: 'relative', \n                overflow: 'hidden',\n                background: `\n                    linear-gradient(135deg, #111118 0%, #1a1a24 100%)\n                    repeating-linear-gradient(rgba(255, 255, 255, 0.03) 0px, rgba(255, 255, 255, 0.03) 1px, transparent 1px, transparent 20px),\n                    repeating-linear-gradient(90deg, rgba(255, 255, 255, 0.03) 0px, rgba(255, 255, 255, 0.03) 1px, transparent 1px, transparent 20px)\n                `,\n                backgroundSize: `\n                    100% 100%,\n                    20px 20px,\n                    20px 20px\n                `,\n                cursor: isPanning ? 'grabbing' : connecting.from !== null ? 'crosshair' : 'default',\n                boxShadow: 'inset 0 0 50px rgba(0, 0, 0, 0.2)'\n            }}\n            onWheel={handleWheel}\n            onMouseDown={handlePanStart}\n            onMouseMove={handleMouseMove}\n            onMouseUp={handleMouseUp}\n            onClick={handleCanvasClick}\n            onDragOver={(e) => e.preventDefault()}\n            onDrop={(e) => {\n                e.preventDefault();\n                try {\n                    const data = e.dataTransfer.getData('text/plain');\n                    const layer = JSON.parse(data);\n                    \n                    // Calculate drop position relative to canvas\n                    const rect = canvasRef.current?.getBoundingClientRect();\n                    if (rect) {\n                        const x = e.clientX - rect.left;\n                        const y = e.clientY - rect.top;\n                        \n                        handleDrop({\n                            ...layer,\n                            x: x - 60,\n                            y: y - 50\n                        });\n                    }\n                } catch (error) {\n                    console.error('Failed to parse dropped data:', error);\n                }\n            }}\n            tabIndex={0}\n        >\n            {/* Zoom controls */}\n            <div style={{\n                position: 'absolute',\n                top: 10,\n                right: 10,\n                zIndex: 200,\n                display: 'flex',\n                flexDirection: 'column',\n                gap: 5,\n                background: 'linear-gradient(135deg, #151520 0%, #1e1e2d 100%)',\n                padding: 8,\n                borderRadius: 10,\n                border: '1px solid rgba(255, 255, 255, 0.1)',\n                boxShadow: '0 2px 15px rgba(0, 0, 0, 0.2)'\n            }}>\n                <button\n                    onClick={() => setCanvasTransform(prev => ({ ...prev, scale: Math.min(3, prev.scale * 1.2) }))}\n                    style={{\n                        background: 'linear-gradient(135deg, #4776E6 0%, #8E54E9 100%)',\n                        border: 'none',\n                        color: '#fff',\n                        padding: '6px 10px',\n                        borderRadius: 6,\n                        cursor: 'pointer',\n                        fontWeight: 'bold'\n                    }}\n                >\n                    +\n                </button>\n                <button\n                    onClick={() => setCanvasTransform(prev => ({ ...prev, scale: Math.max(0.1, prev.scale / 1.2) }))}\n                    style={{\n                        background: 'linear-gradient(135deg, #4776E6 0%, #8E54E9 100%)',\n                        border: 'none',\n                        color: '#fff',\n                        padding: '6px 10px',\n                        borderRadius: 6,\n                        cursor: 'pointer',\n                        fontWeight: 'bold'\n                    }}\n                >\n                    -\n                </button>\n                <button\n                    onClick={resetTransform}\n                    style={{\n                        background: 'rgba(255, 255, 255, 0.1)',\n                        border: 'none',\n                        color: '#fff',\n                        padding: '6px 10px',\n                        borderRadius: 6,\n                        cursor: 'pointer',\n                        fontSize: 10\n                    }}\n                >\n                    Reset\n                </button>\n                <div style={{ \n                    color: '#fff', \n                    fontSize: 10, \n                    textAlign: 'center',\n                    padding: '4px 0',\n                    background: 'rgba(255, 255, 255, 0.1)',\n                    borderRadius: 6\n                }}>\n                    {Math.round(canvasTransform.scale * 100)}%\n                </div>\n            </div>\n\n            {/* Help text */}\n            <div style={{\n                position: 'absolute',\n                bottom: 10,\n                left: 10,\n                color: '#b0b8c4',\n                fontSize: 11,\n                background: 'linear-gradient(135deg, rgba(30, 30, 45, 0.8) 0%, rgba(40, 40, 60, 0.8) 100%)',\n                padding: '8px 12px',\n                borderRadius: 8,\n                zIndex: 200,\n                backdropFilter: 'blur(5px)',\n                boxShadow: '0 2px 10px rgba(0, 0, 0, 0.2)',\n                border: '1px solid rgba(255, 255, 255, 0.1)'\n            }}>\n                Scroll to zoom  Ctrl+Click or Middle-click to pan<br/>\n                Click red dot then green dot to connect nodes\n            </div>\n\n            {/* Canvas content with transform */}\n            <div\n                ref={contentRef}\n                style={{\n                    transform: `translate(${canvasTransform.x}px, ${canvasTransform.y}px) scale(${canvasTransform.scale})`,\n                    transformOrigin: '0 0',\n                    position: 'absolute',\n                    width: '100%',\n                    height: '100%',\n                    zIndex: 10,\n                    pointerEvents: 'auto',\n                    backgroundImage: `\n                        linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),\n                        linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px)\n                    `,\n                    backgroundSize: '20px 20px',\n                    backgroundPosition: '0 0'\n                }}\n            >\n                {/* Render blocks */}\n                {layers.map((layer) => {\n                    const LayerComponent = layerComponentMap[layer.type];\n                    if (!LayerComponent) return null;\n                    \n                    const isSelected = selectedLayerId === layer.id;\n                    const isConnecting = connecting.from === layer.id;\n                    const isNearbyTarget = nearbyHandle === layer.id;\n                    \n                    // Get gradient based on layer type\n                    const getLayerGradient = (type: LayerType) => {\n                        const gradients: Record<LayerType, string> = {\n                            InputLayer: 'linear-gradient(135deg, #36d1dc 0%, #5b86e5 100%)',\n                            Conv2DLayer: 'linear-gradient(135deg, #ff6a00 0%, #ee0979 100%)',\n                            OutputLayer: 'linear-gradient(135deg, #00c6ff 0%, #0072ff 100%)',\n                            ConcatLayer: 'linear-gradient(135deg, #834d9b 0%, #d04ed6 100%)',\n                            LinearLayer: 'linear-gradient(135deg, #4776E6 0%, #8E54E9 100%)',\n                            FlattenLayer: 'linear-gradient(135deg, #fc4a1a 0%, #f7b733 100%)',\n                            MaxPoolLayer: 'linear-gradient(135deg, #11998e 0%, #38ef7d 100%)'\n                        };\n                        return gradients[type] || 'linear-gradient(135deg, #333 0%, #555 100%)';\n                    };\n                    \n                    // Inline parameter editing UI for demo\n                    const paramInputs = Object.keys(layer.parameters)\n    .filter(param => !['activation', 'activationFunction'].includes(param))\n    .map(param => {\n    const value = layer.parameters[param];\n    const displayValue = Array.isArray(value) ? value.join(', ') : String(value);\n    \n    return (\n                            <div key={param} style={{ marginBottom: 8 }}>\n                                <label style={{ fontSize: 12, color: '#b0b8c4', fontWeight: 500 }}>{param}: </label>\n                                <input\n                                    style={{ \n                                        fontSize: 12, \n                                        width: 90,\n                                        backgroundColor: 'rgba(255, 255, 255, 0.07)',\n                                        border: '1px solid rgba(255, 255, 255, 0.1)',\n                                        color: '#ffffff',\n                                        padding: '4px 8px',\n                                        borderRadius: '6px',\n                                        outline: 'none'\n                                    }}\n                                    value={displayValue}\n                                    onChange={e => handleParamChange(layer.id, param, e.target.value)}\n                                    placeholder={param.includes('Shape') ? \"e.g. 28, 28, 1\" : \"\"}\n                                    onMouseDown={(e) => e.stopPropagation()}\n                                    onFocus={(e) => e.stopPropagation()}\n                                />\n                            </div>\n                        );\n                    });\n                    \n                    return (\n                        <div key={layer.id}>\n                            {/* Input Handle */}\n                            <div\n                                style={{\n                                    position: 'absolute',\n                                    left: layer.x - 8,\n                                    top: layer.y + 42,\n                                    width: 16,\n                                    height: 16,\n                                    background: isNearbyTarget \n                                        ? 'linear-gradient(135deg, #00b09b 0%, #96c93d 100%)' \n                                        : 'linear-gradient(135deg, #11998e 0%, #38ef7d 100%)',\n                                    borderRadius: '50%',\n                                    border: '2px solid #ffffff',\n                                    cursor: 'pointer',\n                                    zIndex: 100,\n                                    boxShadow: isNearbyTarget \n                                        ? '0 0 12px rgba(0, 176, 155, 0.8)' \n                                        : '0 2px 8px rgba(0, 0, 0, 0.3)',\n                                    transform: isNearbyTarget ? 'scale(1.2)' : 'scale(1)',\n                                    transition: 'all 0.2s ease',\n                                    pointerEvents: 'auto'\n                                }}\n                                onMouseDown={(e) => {\n                                    console.log('Input handle mouse down'); // Debug log\n                                    handleConnectionStart(layer.id, 'input', e);\n                                }}\n                                onMouseUp={(e) => {\n                                    console.log('Input handle mouse up'); // Debug log\n                                    handleConnectionEnd(layer.id, 'input', e);\n                                }}\n                                onClick={(e) => {\n                                    console.log('Input handle clicked'); // Debug log\n                                    e.preventDefault();\n                                    e.stopPropagation();\n                                }}\n                                title=\"Input - Click to connect from another node's output\"\n                            />\n                            \n                            {/* Main Node */}\n                            <div\n                                data-layer-id={layer.id}\n                                style={{\n                                    position: 'absolute',\n                                    left: layer.x,\n                                    top: layer.y,\n                                    background: isConnecting \n                                        ? 'linear-gradient(135deg, #0f0f15 0%, #2c3e50 100%)' \n                                        : isSelected \n                                            ? 'linear-gradient(135deg, #24243e 0%, #302b63 100%)'\n                                            : 'linear-gradient(135deg, #1e1e2d 0%, #2a2a38 100%)',\n                                    border: isConnecting \n                                        ? `2px solid ${getLayerGradient(layer.type)}` \n                                        : isSelected \n                                            ? '2px solid #ff6b6b' \n                                            : '1px solid rgba(255, 255, 255, 0.1)',\n                                    borderRadius: 12,\n                                    padding: 16,\n                                    minWidth: 120,\n                                    cursor: connecting.from !== null ? 'crosshair' : isPanning ? 'grabbing' : 'move',\n                                    zIndex: draggedId === layer.id ? 80 : 30,\n                                    color: '#ffffff',\n                                    boxShadow: isSelected \n                                        ? '0 0 20px rgba(255, 107, 107, 0.3)' \n                                        : '0 4px 20px rgba(0, 0, 0, 0.2)',\n                                    userSelect: 'none',\n                                    WebkitUserSelect: 'none',\n                                    MozUserSelect: 'none',\n                                    msUserSelect: 'none',\n                                    pointerEvents: 'auto',\n                                    backdropFilter: 'blur(5px)'\n                                }}\n                                onMouseDown={e => handleMouseDown(layer.id, e)}\n                            >\n                                {/* Subtle indicator of layer type at the top */}\n                                <div style={{\n                                    height: '4px',\n                                    background: getLayerGradient(layer.type),\n                                    borderRadius: '10px',\n                                    marginBottom: '10px',\n                                    opacity: 0.8\n                                }}></div>\n                                \n                                <LayerComponent {...layer.parameters} />\n                                <div style={{ marginTop: 12, userSelect: 'none' }}>{paramInputs}</div>\n                            </div>\n                            \n                            {/* Output Handle */}\n                            <div\n                                style={{\n                                    position: 'absolute',\n                                    left: layer.x + (layer.width || 270) + 8,\n                                    top: layer.y + 42,\n                                    width: 16,\n                                    height: 16,\n                                    background: 'linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%)',\n                                    borderRadius: '50%',\n                                    border: '2px solid #ffffff',\n                                    cursor: 'pointer',\n                                    zIndex: 100,\n                                    boxShadow: connecting.from === layer.id \n                                        ? '0 0 12px rgba(255, 65, 108, 0.8)' \n                                        : '0 2px 8px rgba(0, 0, 0, 0.3)',\n                                    transform: connecting.from === layer.id ? 'scale(1.2)' : 'scale(1)',\n                                    transition: 'all 0.2s ease',\n                                    pointerEvents: 'auto'\n                                }}\n                                onMouseDown={(e) => {\n                                    console.log('Output handle mouse down'); // Debug log\n                                    handleConnectionStart(layer.id, 'output', e);\n                                }}\n                                onMouseUp={(e) => {\n                                    console.log('Output handle mouse up'); // Debug log\n                                    handleConnectionEnd(layer.id, 'output', e);\n                                }}\n                                onClick={(e) => {\n                                    console.log('Output handle clicked'); // Debug log\n                                    e.preventDefault();\n                                    e.stopPropagation();\n                                }}\n                                title=\"Output - Click and drag to connect to another node's output\"\n                            />\n                        </div>\n                    );\n                })}\n            </div>\n\n            {/* Render connection lines */}\n            {renderConnections()}\n        </div>\n    );\n});\n\nexport default Canvas;","import React from 'react';\n\ninterface InputLayerProps {\n    inputShape?: number[];\n}\n\nconst InputLayer: React.FC<InputLayerProps> = ({ inputShape = [28, 28, 1] }) => {\n    return (\n        <div style={{ userSelect: 'none' }}>\n            <h4 style={{ \n                margin: 0, \n                fontSize: 16, \n                color: '#ffffff', \n                userSelect: 'none',\n                fontWeight: 600,\n                textShadow: '0 1px 2px rgba(0, 0, 0, 0.3)'\n            }}>Input Layer</h4>\n            <div style={{ \n                fontSize: 13, \n                color: '#b0b8c4', \n                userSelect: 'none',\n                marginTop: 6,\n                background: 'rgba(255, 255, 255, 0.05)',\n                padding: '6px 10px',\n                borderRadius: 8,\n                border: '1px solid rgba(255, 255, 255, 0.1)'\n            }}>\n                Shape: [{inputShape.join(', ')}]\n            </div>\n        </div>\n    );\n};\n\nexport default InputLayer;","import React, { useState } from 'react';\n\ninterface Conv2DLayerProps {\n    filterSize?: number;\n    numFilters?: number;\n    activationFunction?: string;\n}\n\nconst Conv2DLayer: React.FC<Conv2DLayerProps> = ({ \n    filterSize = 3, \n    numFilters = 32, \n    activationFunction = 'relu' \n}) => {\n    const [localFilterSize, setLocalFilterSize] = useState(filterSize);\n    const [localNumFilters, setLocalNumFilters] = useState(numFilters);\n    const [localActivationFunction, setLocalActivationFunction] = useState(activationFunction);\n\n    const handleFilterSizeChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        setLocalFilterSize(Number(event.target.value));\n    };\n\n    const handleNumFiltersChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        setLocalNumFilters(Number(event.target.value));\n    };\n\n    const handleActivationFunctionChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\n        setLocalActivationFunction(event.target.value);\n    };\n\n    return (\n        <div className=\"conv2d-layer\" style={{ userSelect: 'none' }}>\n            <h4 style={{ \n                color: '#ffffff', \n                margin: 0, \n                fontSize: 16, \n                userSelect: 'none',\n                fontWeight: 600,\n                textShadow: '0 1px 2px rgba(0, 0, 0, 0.3)'\n            }}>Conv2D Layer</h4>\n            \n            <div style={{ \n                marginTop: 10, \n                background: 'rgba(255, 255, 255, 0.05)',\n                padding: '10px',\n                borderRadius: 8,\n                border: '1px solid rgba(255, 255, 255, 0.1)'\n            }}>\n                <div style={{ marginBottom: 8, userSelect: 'none' }}>\n                    <label style={{ color: '#b0b8c4', fontSize: 12, userSelect: 'none', fontWeight: 500 }}>Filter Size:</label>\n                    <input \n                        type=\"number\" \n                        value={localFilterSize} \n                        onChange={handleFilterSizeChange}\n                        style={{\n                            backgroundColor: 'rgba(255, 255, 255, 0.07)',\n                            border: '1px solid rgba(255, 255, 255, 0.1)',\n                            color: '#ffffff',\n                            padding: '4px 8px',\n                            borderRadius: '6px',\n                            width: '60px',\n                            marginLeft: '4px',\n                            outline: 'none'\n                        }}\n                    />\n                </div>\n                <div style={{ marginBottom: 8, userSelect: 'none' }}>\n                    <label style={{ color: '#b0b8c4', fontSize: 12, userSelect: 'none', fontWeight: 500 }}>Filters:</label>\n                    <input \n                        type=\"number\" \n                        value={localNumFilters} \n                        onChange={handleNumFiltersChange}\n                        style={{\n                            backgroundColor: 'rgba(255, 255, 255, 0.07)',\n                            border: '1px solid rgba(255, 255, 255, 0.1)',\n                            color: '#ffffff',\n                            padding: '4px 8px',\n                            borderRadius: '6px',\n                            width: '60px',\n                            marginLeft: '4px',\n                            outline: 'none'\n                        }}\n                    />\n                </div>\n                <div style={{ marginBottom: 4, userSelect: 'none' }}>\n                    <label style={{ color: '#b0b8c4', fontSize: 12, userSelect: 'none', fontWeight: 500 }}>Activation:</label>\n                    <select \n                        value={localActivationFunction} \n                        onChange={handleActivationFunctionChange}\n                        style={{\n                            backgroundColor: 'rgba(255, 255, 255, 0.07)',\n                            border: '1px solid rgba(255, 255, 255, 0.1)',\n                            color: '#ffffff',\n                            padding: '4px 8px',\n                            borderRadius: '6px',\n                            marginLeft: '4px',\n                            outline: 'none'\n                        }}\n                    >\n                        <option value=\"relu\">ReLU</option>\n                        <option value=\"sigmoid\">Sigmoid</option>\n                        <option value=\"tanh\">Tanh</option>\n                    </select>\n                </div>\n            </div>\n            \n            <div style={{ \n                fontSize: 12, \n                color: '#8a9db8', \n                marginTop: 8, \n                userSelect: 'none',\n                padding: '4px 0'\n            }}>\n                <div>Filters: <span style={{ color: '#b5ffb5' }}>{localNumFilters}</span></div>\n                <div>Size: <span style={{ color: '#b5ffb5' }}>{localFilterSize}{localFilterSize}</span></div>\n                <div>Activation: <span style={{ color: '#b5ffb5' }}>{localActivationFunction}</span></div>\n            </div>\n        </div>\n    );\n};\n\nexport default Conv2DLayer;","import React, { useState } from 'react';\n\ninterface OutputLayerProps {\n    outputShape?: number[];\n    activationFunction?: string;\n}\n\nconst OutputLayer: React.FC<OutputLayerProps> = ({ \n    outputShape = [10], \n    activationFunction = 'softmax' \n}) => {\n    const [localActivation, setLocalActivation] = useState(activationFunction);\n\n    const handleActivationChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\n        setLocalActivation(event.target.value);\n    };\n\n    return (\n        <div style={{ userSelect: 'none' }}>\n            <h4 style={{ \n                margin: 0, \n                fontSize: 16, \n                color: '#ffffff', \n                userSelect: 'none',\n                fontWeight: 600,\n                textShadow: '0 1px 2px rgba(0, 0, 0, 0.3)'\n            }}>Output Layer</h4>\n            <div style={{ \n                fontSize: 13, \n                color: '#b0b8c4', \n                userSelect: 'none',\n                marginTop: 6,\n                background: 'rgba(255, 255, 255, 0.05)',\n                padding: '6px 10px',\n                borderRadius: 8,\n                border: '1px solid rgba(255, 255, 255, 0.1)'\n            }}>\n                <div style={{ marginBottom: 4 }}>Shape: [{outputShape.join(', ')}]</div>\n                <div>\n                    <label>Activation: </label>\n                    <select \n                        value={localActivation} \n                        onChange={handleActivationChange}\n                        style={{\n                            backgroundColor: 'rgba(40, 44, 52, 0.9)',\n                            border: '1px solid rgba(255, 255, 255, 0.2)',\n                            color: '#ffffff',\n                            padding: '2px 4px',\n                            borderRadius: '4px',\n                            fontSize: '12px',\n                            outline: 'none'\n                        }}\n                    >\n                        <option value=\"softmax\" style={{ backgroundColor: '#2d2d3a', color: 'white' }}>Softmax</option>\n                        <option value=\"sigmoid\" style={{ backgroundColor: '#2d2d3a', color: 'white' }}>Sigmoid</option>\n                        <option value=\"relu\" style={{ backgroundColor: '#2d2d3a', color: 'white' }}>ReLU</option>\n                        <option value=\"tanh\" style={{ backgroundColor: '#2d2d3a', color: 'white' }}>Tanh</option>\n                        <option value=\"none\" style={{ backgroundColor: '#2d2d3a', color: 'white' }}>None</option>\n                    </select>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default OutputLayer;","import React from 'react';\n\ninterface ConcatLayerProps {\n    layers?: any[];\n}\n\nconst ConcatLayer: React.FC<ConcatLayerProps> = ({ layers = [] }) => {\n    return (\n        <div style={{ userSelect: 'none' }}>\n            <h4 style={{ margin: 0, fontSize: 14, color: '#ffffff', userSelect: 'none' }}>Concat Layer</h4>\n            <div style={{ fontSize: 12, color: '#ccc', userSelect: 'none' }}>\n                Inputs: {layers.length}\n            </div>\n        </div>\n    );\n};\n\nexport default ConcatLayer;","import React, { useState } from 'react';\r\n\r\ninterface LinearLayerProps {\r\n    inputSize?: number;\r\n    outputSize?: number;\r\n    bias?: boolean;\r\n    activation?: string;\r\n}\r\n\r\nconst LinearLayer: React.FC<LinearLayerProps> = ({ \r\n    inputSize = 128, \r\n    outputSize = 64, \r\n    bias = true,\r\n    activation = 'none'\r\n}) => {\r\n    const [localActivation, setLocalActivation] = useState(activation);\r\n\r\n    const handleActivationChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\r\n        setLocalActivation(event.target.value);\r\n    };\r\n\r\n    return (\r\n        <div style={{\r\n            padding: '8px',\r\n            backgroundColor: '#2a2a2a',\r\n            borderRadius: '4px',\r\n            minWidth: '120px',\r\n            textAlign: 'center'\r\n        }}>\r\n            <div style={{ fontWeight: 'bold', marginBottom: '4px', color: '#4caf50' }}>\r\n                Linear Layer\r\n            </div>\r\n            <div style={{ fontSize: '12px', color: '#ccc' }}>\r\n                Input: {inputSize}\r\n            </div>\r\n            <div style={{ fontSize: '12px', color: '#ccc' }}>\r\n                Output: {outputSize}\r\n            </div>\r\n            <div style={{ fontSize: '10px', color: '#888', marginTop: '4px' }}>\r\n                Bias: {bias ? 'Yes' : 'No'}\r\n            </div>\r\n            <div style={{ fontSize: '10px', color: '#888', marginTop: '4px' }}>\r\n                <label>Activation: </label>\r\n                <select \r\n                    value={localActivation} \r\n                    onChange={handleActivationChange}\r\n                    style={{\r\n                        backgroundColor: 'rgba(40, 44, 52, 0.9)',\r\n                        border: '1px solid rgba(255, 255, 255, 0.2)',\r\n                        color: '#ffffff',\r\n                        padding: '2px 4px',\r\n                        borderRadius: '4px',\r\n                        fontSize: '10px',\r\n                        outline: 'none'\r\n                    }}\r\n                >\r\n                    <option value=\"relu\" style={{ backgroundColor: '#2d2d3a', color: 'white' }}>ReLU</option>\r\n                    <option value=\"sigmoid\" style={{ backgroundColor: '#2d2d3a', color: 'white' }}>Sigmoid</option>\r\n                    <option value=\"tanh\" style={{ backgroundColor: '#2d2d3a', color: 'white' }}>Tanh</option>\r\n                    <option value=\"none\" style={{ backgroundColor: '#2d2d3a', color: 'white' }}>None</option>\r\n                </select>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default LinearLayer;\r\n","  import React from 'react';\r\n\r\ninterface FlattenLayerProps {\r\n    startDim?: number;\r\n    endDim?: number;\r\n}\r\n\r\nconst FlattenLayer: React.FC<FlattenLayerProps> = ({ \r\n    startDim = 1, \r\n    endDim = -1\r\n}) => {\r\n    return (\r\n        <div style={{\r\n            padding: '8px',\r\n            backgroundColor: '#2a2a2a',\r\n            borderRadius: '4px',\r\n            minWidth: '120px',\r\n            textAlign: 'center'\r\n        }}>\r\n            <div style={{ fontWeight: 'bold', marginBottom: '4px', color: '#ff9800' }}>\r\n                Flatten Layer\r\n            </div>\r\n            <div style={{ fontSize: '12px', color: '#ccc' }}>\r\n                Reshape to 1D\r\n            </div>\r\n            <div style={{ fontSize: '10px', color: '#888', marginTop: '4px' }}>\r\n                Start Dim: {startDim}\r\n            </div>\r\n            <div style={{ fontSize: '10px', color: '#888' }}>\r\n                End Dim: {endDim === -1 ? 'Last' : endDim}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default FlattenLayer;\r\n","import React from 'react';\r\n\r\ninterface MaxPoolLayerProps {\r\n    poolSize?: number;\r\n    stride?: number;\r\n    padding?: string;\r\n}\r\n\r\nconst MaxPoolLayer: React.FC<MaxPoolLayerProps> = ({ \r\n    poolSize = 2, \r\n    stride = 2,\r\n    padding = 'valid'\r\n}) => {\r\n    return (\r\n        <div style={{\r\n            padding: '8px',\r\n            backgroundColor: '#2a2a2a',\r\n            borderRadius: '4px',\r\n            minWidth: '120px',\r\n            textAlign: 'center'\r\n        }}>\r\n            <div style={{ fontWeight: 'bold', marginBottom: '4px', color: '#42a5f5' }}>\r\n                MaxPool Layer\r\n            </div>\r\n            <div style={{ fontSize: '12px', color: '#ccc' }}>\r\n                Pool Size: {poolSize}{poolSize}\r\n            </div>\r\n            <div style={{ fontSize: '12px', color: '#ccc' }}>\r\n                Stride: {stride}\r\n            </div>\r\n            <div style={{ fontSize: '10px', color: '#888', marginTop: '4px' }}>\r\n                Padding: {padding}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MaxPoolLayer;\r\n","import React, { useEffect, useRef } from 'react';\n\nconst LayerLibrary: React.FC = () => {\n    const layers = [\n        { type: 'InputLayer', name: 'Input Layer', icon: '', color: 'linear-gradient(135deg, #36d1dc 0%, #5b86e5 100%)' },\n        { type: 'Conv2DLayer', name: 'Conv2D Layer', icon: '', color: 'linear-gradient(135deg, #ff6a00 0%, #ee0979 100%)' },\n        { type: 'MaxPoolLayer', name: 'MaxPool Layer', icon: '', color: 'linear-gradient(135deg, #11998e 0%, #38ef7d 100%)' },\n        { type: 'FlattenLayer', name: 'Flatten Layer', icon: '', color: 'linear-gradient(135deg, #fc4a1a 0%, #f7b733 100%)' },\n        { type: 'LinearLayer', name: 'Linear Layer', icon: '', color: 'linear-gradient(135deg, #4776E6 0%, #8E54E9 100%)' },\n        { type: 'OutputLayer', name: 'Output Layer', icon: '', color: 'linear-gradient(135deg, #00c6ff 0%, #0072ff 100%)' },\n        { type: 'ConcatLayer', name: 'Concat Layer', icon: '', color: 'linear-gradient(135deg, #834d9b 0%, #d04ed6 100%)' },\n    ];\n\n    const handleDragStart = (e: React.DragEvent, layerType: string) => {\n        const layerData = {\n            type: layerType,\n            id: Date.now() + Math.random()\n        };\n        e.dataTransfer.setData('text/plain', JSON.stringify(layerData));\n    };\n\n    const adWrapperRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        const wrapper = adWrapperRef.current;\n        if (!wrapper) return;\n\n        // Avoid duplicates if re-mounted\n        if (wrapper.querySelector('script[src*=\"pl27691637.revenuecpmgate.com/f38a87df06df03f6f6d712c37c70cdc1/invoke.js\"]')) {\n            return;\n        }\n\n        const script = document.createElement('script');\n        script.async = true;\n        script.setAttribute('data-cfasync', 'false');\n        script.src = '//pl27691637.revenuecpmgate.com/f38a87df06df03f6f6d712c37c70cdc1/invoke.js';\n\n        wrapper.appendChild(script);\n\n        return () => {\n            wrapper.innerHTML = '';\n        };\n    }, []);\n\n    return (\n        <div style={{\n            width: '250px',\n            background: 'linear-gradient(135deg, #0f0f15 0%, #151520 100%)',\n            padding: '16px',\n            borderRight: '1px solid rgba(255, 255, 255, 0.1)',\n            height: 'calc(100vh - 80px)', \n            overflowY: 'auto',\n            boxShadow: '0 4px 20px rgba(0, 0, 0, 0.2)'\n        }}>\n            <h3 style={{ \n                color: '#ffffff', \n                marginTop: 0, \n                marginBottom: '16px',\n                fontSize: '18px',\n                fontWeight: 600,\n                borderBottom: '1px solid rgba(255, 255, 255, 0.1)',\n                paddingBottom: '10px',\n                letterSpacing: '0.5px'\n            }}>\n                Layer Library\n            </h3>\n            \n            <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n                {layers.map((layer) => (\n                    <div\n                        key={layer.type}\n                        draggable\n                        onDragStart={(e) => handleDragStart(e, layer.type)}\n                        style={{\n                            padding: '12px',\n                            background: '#1e1e2d',\n                            borderRadius: '10px',\n                            cursor: 'grab',\n                            transition: 'all 0.3s ease',\n                            display: 'flex',\n                            alignItems: 'center',\n                            gap: '12px',\n                            boxShadow: '0 2px 10px rgba(0, 0, 0, 0.1)',\n                            position: 'relative',\n                            overflow: 'hidden'\n                        }}\n                        onMouseDown={(e) => e.currentTarget.style.cursor = 'grabbing'}\n                        onMouseUp={(e) => e.currentTarget.style.cursor = 'grab'}\n                        onMouseOver={(e) => {\n                            e.currentTarget.style.transform = 'translateY(-2px)';\n                            e.currentTarget.style.boxShadow = '0 4px 15px rgba(0, 0, 0, 0.2)';\n                        }}\n                        onMouseOut={(e) => {\n                            e.currentTarget.style.transform = 'translateY(0)';\n                            e.currentTarget.style.boxShadow = '0 2px 10px rgba(0, 0, 0, 0.1)';\n                        }}\n                    >\n                        {/* Color indicator with gradient */}\n                        <div style={{\n                            position: 'absolute',\n                            left: 0,\n                            top: 0,\n                            bottom: 0,\n                            width: '5px',\n                            background: layer.color,\n                            borderTopLeftRadius: '10px',\n                            borderBottomLeftRadius: '10px'\n                        }} />\n                        \n                        <div style={{ \n                            width: '36px', \n                            height: '36px',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center',\n                            background: 'rgba(255, 255, 255, 0.05)',\n                            borderRadius: '8px',\n                            fontSize: '20px',\n                            marginLeft: '5px'\n                        }}>\n                            {layer.icon}\n                        </div>\n                        \n                        <span style={{ \n                            color: '#ffffff', \n                            fontWeight: '500',\n                            fontSize: '14px'\n                        }}>\n                            {layer.name}\n                        </span>\n                    </div>\n                ))}\n            </div>\n\n            {/* Sponsored block */}\n            <div style={{\n                marginTop: '16px',\n                padding: '12px',\n                background: 'rgba(255, 255, 255, 0.02)',\n                borderRadius: '8px',\n                border: '1px solid rgba(255, 255, 255, 0.05)'\n            }}>\n                <div style={{\n                    fontSize: '11px',\n                    color: '#8a9db8',\n                    marginBottom: '8px',\n                    textTransform: 'uppercase',\n                    letterSpacing: '0.5px'\n                }}>\n                    Sponsored\n                </div>\n                <div ref={adWrapperRef}>\n                    <div\n                        id=\"container-f38a87df06df03f6f6d712c37c70cdc1\"\n                        style={{\n                            minHeight: 250,\n                            background: 'rgba(255, 255, 255, 0.05)',\n                            borderRadius: 6\n                        }}\n                    />\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default LayerLibrary;","import React, { useEffect, useRef } from 'react';\n\ninterface TrainingOptions {\n    batchSize: number;\n    epochs: number;\n    learningRate: number;\n    optimizer: string;\n    lossFunction: string;\n}\n\ninterface PropertiesPanelProps {\n    trainingOptions: TrainingOptions;\n    onOptionChange: (option: string, value: any) => void;\n}\n\nconst PropertiesPanel: React.FC<PropertiesPanelProps> = ({ trainingOptions, onOptionChange }) => {\n    const adContainerRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        // Load the ad script dynamically without TS assertions\n        const container = adContainerRef.current;\n        if (!container) return;\n\n        // Clear and inject config + invoke scripts\n        container.innerHTML = '';\n\n        const configScript = document.createElement('script');\n        configScript.type = 'text/javascript';\n        configScript.text = `\n            atOptions = {\n                'key' : 'a4a25afffd74b77d668b2be8c7cf8d59',\n                'format' : 'iframe',\n                'height' : 300,\n                'width' : 160,\n                'params' : {}\n            };\n        `;\n\n        const invokeScript = document.createElement('script');\n        invokeScript.type = 'text/javascript';\n        invokeScript.src = '//www.highperformanceformat.com/a4a25afffd74b77d668b2be8c7cf8d59/invoke.js';\n        invokeScript.async = true;\n\n        container.appendChild(configScript);\n        container.appendChild(invokeScript);\n\n        return () => {\n            // Cleanup on unmount\n            container.innerHTML = '';\n        };\n    }, []);\n\n    return (\n        <div style={{ \n            width: 200, \n            borderLeft: '1px solid rgba(255, 255, 255, 0.1)', \n            padding: 16, \n            background: 'linear-gradient(135deg, #0f0f15 0%, #151520 100%)',\n            color: '#ffffff',\n            height: 'calc(100vh - 80px)',\n            overflowY: 'auto',\n            boxShadow: '-2px 0 15px rgba(0, 0, 0, 0.2)'\n        }}>\n            <h3 style={{ \n                color: '#ffffff', \n                marginTop: 0,\n                borderBottom: '1px solid rgba(255, 255, 255, 0.1)',\n                paddingBottom: '10px',\n                fontWeight: 600,\n                letterSpacing: '0.5px'\n            }}>Training Options</h3>\n            \n            <div style={{\n                marginTop: '12px',\n                display: 'flex',\n                flexDirection: 'column',\n                gap: '16px'\n            }}>\n                {/* Batch Size */}\n                <div className=\"training-option\">\n                    <label style={{ display: 'block', marginBottom: '6px', color: '#b0b8c4', fontSize: '14px', fontWeight: 500 }}>Batch Size</label>\n                    <input\n                        type=\"number\"\n                        value={trainingOptions.batchSize}\n                        onChange={(e) => onOptionChange('batchSize', Number(e.target.value))}\n                        style={{\n                            width: '100%', padding: '8px 10px', background: 'rgba(255, 255, 255, 0.07)',\n                            border: '1px solid rgba(255, 255, 255, 0.1)', borderRadius: '8px', color: 'white',\n                            fontSize: '14px', outline: 'none', boxSizing: 'border-box'\n                        }}\n                    />\n                </div>\n\n                {/* Epochs */}\n                <div className=\"training-option\">\n                    <label style={{ display: 'block', marginBottom: '6px', color: '#b0b8c4', fontSize: '14px', fontWeight: 500 }}>Epochs</label>\n                    <input\n                        type=\"number\"\n                        value={trainingOptions.epochs}\n                        onChange={(e) => onOptionChange('epochs', Number(e.target.value))}\n                        style={{\n                            width: '100%', padding: '8px 10px', background: 'rgba(255, 255, 255, 0.07)',\n                            border: '1px solid rgba(255, 255, 255, 0.1)', borderRadius: '8px', color: 'white',\n                            fontSize: '14px', outline: 'none', boxSizing: 'border-box'\n                        }}\n                    />\n                </div>\n\n                {/* Learning Rate */}\n                <div className=\"training-option\">\n                    <label style={{ display: 'block', marginBottom: '6px', color: '#b0b8c4', fontSize: '14px', fontWeight: 500 }}>Learning Rate</label>\n                    <input\n                        type=\"number\"\n                        step=\"0.0001\"\n                        value={trainingOptions.learningRate}\n                        onChange={(e) => onOptionChange('learningRate', Number(e.target.value))}\n                        style={{\n                            width: '100%', padding: '8px 10px', background: 'rgba(255, 255, 255, 0.07)',\n                            border: '1px solid rgba(255, 255, 255, 0.1)', borderRadius: '8px', color: 'white',\n                            fontSize: '14px', outline: 'none', boxSizing: 'border-box'\n                        }}\n                    />\n                </div>\n\n                {/* Optimizer */}\n                <div className=\"training-option\">\n                    <label style={{ display: 'block', marginBottom: '6px', color: '#b0b8c4', fontSize: '14px', fontWeight: 500 }}>Optimizer</label>\n                    <select\n                        value={trainingOptions.optimizer}\n                        onChange={(e) => onOptionChange('optimizer', e.target.value)}\n                        style={{\n                            width: '100%', padding: '8px 10px', background: 'rgba(255, 255, 255, 0.07)',\n                            border: '1px solid rgba(255, 255, 255, 0.1)', borderRadius: '8px', color: 'white',\n                            fontSize: '14px', outline: 'none'\n                        }}\n                    >\n                        <option value=\"adam\">Adam</option>\n                        <option value=\"sgd\">SGD</option>\n                        <option value=\"rmsprop\">RMSprop</option>\n                    </select>\n                </div>\n\n                {/* Loss Function */}\n                <div className=\"training-option\">\n                    <label style={{ display: 'block', marginBottom: '6px', color: '#b0b8c4', fontSize: '14px', fontWeight: 500 }}>Loss Function</label>\n                    <select\n                        value={trainingOptions.lossFunction}\n                        onChange={(e) => onOptionChange('lossFunction', e.target.value)}\n                        style={{\n                            width: '100%', padding: '8px 10px', background: 'rgba(255, 255, 255, 0.07)',\n                            border: '1px solid rgba(255, 255, 255, 0.1)', borderRadius: '8px', color: 'white',\n                            fontSize: '14px', outline: 'none'\n                        }}\n                    >\n                        <option value=\"mse\">Mean Squared Error</option>\n                        <option value=\"crossentropy\">Cross Entropy</option>\n                    </select>\n                </div>\n\n                {/* Ad Widget */}\n                <div style={{\n                    marginTop: '20px',\n                    padding: '12px',\n                    background: 'rgba(255, 255, 255, 0.02)',\n                    borderRadius: '8px',\n                    border: '1px solid rgba(255, 255, 255, 0.05)',\n                    textAlign: 'center'\n                }}>\n                    <div style={{\n                        fontSize: '11px',\n                        color: '#8a9db8',\n                        marginBottom: '8px',\n                        textTransform: 'uppercase',\n                        letterSpacing: '0.5px'\n                    }}>\n                        Sponsored\n                    </div>\n                    <div \n                        ref={adContainerRef}\n                        style={{\n                            minHeight: '300px',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center',\n                            background: 'rgba(255, 255, 255, 0.05)',\n                            borderRadius: '6px'\n                        }}\n                    />\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default PropertiesPanel;","import React from 'react';\n\ninterface ToolbarProps {\n  onExport?: () => void;\n  onImport?: () => void;\n}\n\nconst Toolbar: React.FC<ToolbarProps> = ({ onExport, onImport }) => {\n  return (\n    <div className=\"toolbar\" style={{\n      display: 'flex',\n      justifyContent: 'space-between',\n      padding: '12px 20px',\n      background: 'linear-gradient(90deg, #0f0f15 0%, #151520 100%)',\n      borderBottom: '1px solid rgba(255, 255, 255, 0.1)',\n      boxShadow: '0 2px 10px rgba(0,0,0,0.2)'\n    }}>\n      <div style={{ display: 'flex', alignItems: 'center', gap: '15px' }}>\n        <h2 style={{ \n          margin: 0, \n          fontSize: '22px', \n          color: '#fff',\n          fontWeight: 700,\n          letterSpacing: '0.5px',\n          background: 'linear-gradient(to right, #36d1dc, #5b86e5)',\n          WebkitBackgroundClip: 'text',\n          WebkitTextFillColor: 'transparent'\n        }}>Autai</h2>\n        <div style={{\n          display: 'flex',\n          flexDirection: 'column',\n          color: '#8a9db8',\n          fontSize: '12px',\n          borderLeft: '1px solid rgba(255, 255, 255, 0.2)',\n          paddingLeft: '15px',\n          lineHeight: '1.4'\n        }}>\n          <span>By Fadhil</span>\n          <span style={{ fontStyle: 'italic' }}>-Feaven Technologies-</span>\n        </div>\n      </div>\n      \n      <div style={{ display: 'flex', gap: '12px' }}>\n        {/* Import button */}\n        <button \n          onClick={onImport}\n          style={{\n            background: 'linear-gradient(135deg, #11998e 0%, #38ef7d 100%)',\n            color: 'white',\n            border: 'none',\n            padding: '8px 16px',\n            borderRadius: '8px',\n            cursor: 'pointer',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '8px',\n            fontWeight: '600',\n            boxShadow: '0 2px 10px rgba(17, 153, 142, 0.3)',\n            transition: 'all 0.3s ease'\n          }}\n          onMouseOver={(e) => {\n            e.currentTarget.style.transform = 'translateY(-2px)';\n            e.currentTarget.style.boxShadow = '0 4px 15px rgba(17, 153, 142, 0.4)';\n          }}\n          onMouseOut={(e) => {\n            e.currentTarget.style.transform = 'translateY(0)';\n            e.currentTarget.style.boxShadow = '0 2px 10px rgba(17, 153, 142, 0.3)';\n          }}\n        >\n          <span>Import Model</span>\n        </button>\n        \n        {/* Export button */}\n        <button \n          onClick={onExport}\n          style={{\n            background: 'linear-gradient(135deg, #4776E6 0%, #8E54E9 100%)',\n            color: 'white',\n            border: 'none',\n            padding: '8px 16px',\n            borderRadius: '8px',\n            cursor: 'pointer',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '8px',\n            fontWeight: '600',\n            boxShadow: '0 2px 10px rgba(71, 118, 230, 0.3)',\n            transition: 'all 0.3s ease'\n          }}\n          onMouseOver={(e) => {\n            e.currentTarget.style.transform = 'translateY(-2px)';\n            e.currentTarget.style.boxShadow = '0 4px 15px rgba(71, 118, 230, 0.4)';\n          }}\n          onMouseOut={(e) => {\n            e.currentTarget.style.transform = 'translateY(0)';\n            e.currentTarget.style.boxShadow = '0 2px 10px rgba(71, 118, 230, 0.3)';\n          }}\n        >\n          <span>Export Model</span>\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default Toolbar;","import React, { useState, useRef } from 'react';\nimport Canvas from './components/canvas/Canvas';\nimport LayerLibrary from './components/sidebar/LayerLibrary';\nimport PropertiesPanel from './components/sidebar/PropertiesPanel';\nimport Toolbar from './components/controls/Toolbar';\n\ninterface TrainingOptions {\n    batchSize: number;\n    epochs: number;\n    learningRate: number;\n    optimizer: string;\n    lossFunction: string;\n}\n\nconst App: React.FC = () => {\n    // Add state to track export status\n    const [exportStatus, setExportStatus] = useState<{\n        isExporting: boolean;\n        message: string;\n        isError: boolean;\n    }>({\n        isExporting: false,\n        message: '',\n        isError: false\n    });\n    \n    // State for training options\n    const [trainingOptions, setTrainingOptions] = useState<TrainingOptions>({\n        batchSize: 32,\n        epochs: 10,\n        learningRate: 0.001,\n        optimizer: 'adam',\n        lossFunction: 'mse',\n    });\n\n    // Handler to update training options\n    const handleOptionChange = (option: string, value: any) => {\n        setTrainingOptions(prev => ({ ...prev, [option]: value }));\n    };\n\n    // Reference to Canvas component to get model data\n    const canvasRef = useRef<any>(null);\n    \n    // Function to handle export\n    const handleExport = async () => {\n        if (!canvasRef.current) {\n            setExportStatus({\n                isExporting: false,\n                message: 'Canvas reference not available',\n                isError: true\n            });\n            return;\n        }\n        \n        try {\n            setExportStatus({\n                isExporting: true,\n                message: 'Exporting model...',\n                isError: false\n            });\n            \n            // Get model data from Canvas component\n            const modelData = canvasRef.current.getModelData();\n            \n            // Combine model data with training options\n            const exportData = {\n                ...modelData,\n                trainingOptions: trainingOptions\n            };\n\n            // Build endpoint list safely for tunnel/https\n            const isHttps = typeof window !== 'undefined' && window.location.protocol === 'https:';\n            // Read meta without TS assertions/optional chaining\n            const metaTag = document.querySelector('meta[name=\"autai:api-base\"]');\n            const metaApiBase = metaTag ? (metaTag.getAttribute('content') || '').trim() : '';\n            const apiBaseRaw = (process.env.REACT_APP_API_BASE || metaApiBase || '');\n            const apiBase = apiBaseRaw.replace(/\\/+$/, '');\n            const sameOrigin = (typeof window !== 'undefined' ? window.location.origin : '').replace(/\\/+$/, '');\n\n            const candidates = [\n                `${sameOrigin}/api/export-model`,\n                `${sameOrigin}/export-model`,\n                apiBase ? `${apiBase}/api/export-model` : '',\n                apiBase ? `${apiBase}/export-model` : '',\n                !isHttps ? 'http://localhost:5000/api/export-model' : ''\n            ].filter(Boolean);\n\n            // De-duplicate while preserving order\n            const seen = new Set<string>();\n            const endpoints = candidates.filter(u => (seen.has(u) ? false : (seen.add(u), true)));\n\n            let result: any = null;\n            let lastError: any = null;\n\n            for (const url of endpoints) {\n                try {\n                    // Add a timeout to the fetch request\n                    const controller = new AbortController();\n                    const timeoutId = setTimeout(() => controller.abort(), 5000);\n\n                    const response = await fetch(url, {\n                        method: 'POST',\n                        mode: 'cors',\n                        cache: 'no-store',\n                        headers: { 'Content-Type': 'application/json' },\n                        body: JSON.stringify(exportData),\n                        signal: controller.signal\n                    });\n\n                    clearTimeout(timeoutId);\n\n                    const contentType = response.headers.get('content-type') || '';\n                    const isJson = contentType.includes('application/json');\n                    const payload = isJson ? await response.json() : await response.text();\n\n                    if (!response.ok) {\n                        const msg = typeof payload === 'string' ? payload.slice(0, 200) : JSON.stringify(payload);\n                        throw new Error(`HTTP ${response.status} from ${url} - ${msg}`);\n                    }\n\n                    if (!isJson) {\n                        // Likely got HTML (e.g., static host), try next candidate\n                        throw new Error(`Non-JSON response from ${url}: ${String(payload).slice(0, 120)}`);\n                    }\n\n                    result = payload;\n                    break;\n                } catch (err) {\n                    if (err instanceof Error && err.name === 'AbortError') {\n                        lastError = new Error(`Request to ${url} timed out`);\n                    } else {\n                        lastError = err;\n                    }\n                    continue;\n                }\n            }\n\n            if (!result) {\n                throw lastError || new Error('Export failed: no valid response from any endpoint');\n            }\n\n            if (!result.success) {\n                throw new Error(result.message || 'Export failed');\n            }\n            \n            // Create a downloadable file from the Python code\n            const blob = new Blob([result.message], { type: 'text/plain' });\n            const url = URL.createObjectURL(blob);\n            \n            // Create a temporary link element to trigger download\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = 'autai_model.py';\n            document.body.appendChild(a);\n            a.click();\n            \n            // Clean up\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n            \n            setExportStatus({\n                isExporting: false,\n                message: 'Export successful! File downloaded.',\n                isError: false\n            });\n            \n            // Clear status message after 3 seconds\n            setTimeout(() => {\n                setExportStatus(prev => ({\n                    ...prev,\n                    message: ''\n                }));\n            }, 3000);\n            \n        } catch (error) {\n            console.error('Export failed:', error);\n            setExportStatus({\n                isExporting: false,\n                message: `Export failed: ${error instanceof Error ? error.message : 'Unknown error'}`,\n                isError: true\n            });\n        }\n    };\n\n    return (\n        <div className=\"app\" style={{ \n            height: '100vh', \n            display: 'flex', \n            flexDirection: 'column',\n            background: 'linear-gradient(135deg, #0f0f15 0%, #151520 100%)',\n            color: '#ffffff'\n        }}>\n            <Toolbar onExport={handleExport} />\n            \n            {/* Status message */}\n            {exportStatus.message && (\n                <div style={{\n                    padding: '10px 16px',\n                    background: exportStatus.isError \n                        ? 'linear-gradient(90deg, #ff416c 0%, #ff4b2b 100%)' \n                        : 'linear-gradient(90deg, #00b09b 0%, #96c93d 100%)',\n                    color: 'white',\n                    textAlign: 'center',\n                    opacity: exportStatus.message ? 1 : 0,\n                    transition: 'opacity 0.3s',\n                    fontWeight: '500',\n                    boxShadow: '0 2px 10px rgba(0, 0, 0, 0.15)'\n                }}>\n                    {exportStatus.message}\n                </div>\n            )}\n            \n            <div className=\"main-container\" style={{ \n                flex: 1, \n                display: 'flex', \n                overflow: 'hidden',\n                height: 'calc(100vh - 80px)'\n            }}>\n                <LayerLibrary />\n                <div style={{ \n                    flex: 1, \n                    position: 'relative', \n                    overflow: 'hidden',\n                    height: '100%'\n                }}>\n                    <Canvas ref={canvasRef} />\n                </div>\n                <PropertiesPanel \n                    trainingOptions={trainingOptions}\n                    onOptionChange={handleOptionChange}\n                />\n            </div>\n        </div>\n    );\n};\n\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport './components/overrides.css'; // Add this import after other CSS imports\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}